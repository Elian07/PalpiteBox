{"ast":null,"code":"import { GoogleSpreadsheet } from \"google-spreadsheet\";\nimport credentials from \"../../credentials.json\";\nimport moment from \"moment\";\nconst doc = new GoogleSpreadsheet(\"1G_U7ODPp3tY22lO5fhURhxCtos6VAvQcGUJvRMsX1eE\");\nexport default (async (req, res) => {\n  try {\n    await doc.useServiceAccountAuth(credentials);\n    await doc.loadInfo();\n    const sheet = doc.sheetsByIndex[1];\n    const data = JSON.parse(req.body);\n    const sheetConfig = doc.sheetsByIndex[2];\n    await sheetConfig.loadCells(\"A3:B3\");\n    const mostrarPromocaoCell = sheetConfig.getCell(2, 0);\n    const textoCell = sheetConfig.getCell(2, 1);\n    let Cupom = '';\n    let Promo = '';\n\n    if (mostrarPromocaoCell.value === 'VERDADEIRO') {\n      //TO DO gerar cupom\n      Cupom = moment().format('DD/MM/YYYY HH:mm:ss SSS');\n      Promo = textoCell.value;\n    }\n\n    await sheet.addRow({\n      Nome: data.Nome,\n      Email: data.Email,\n      Whatsapp: data.Whatsapp,\n      Nota: '5',\n      'Data Preenchimento': moment().format('DD/MM/YYYY HH:mm:ss'),\n      Cupom,\n      Promo\n    });\n    res.end(req.body);\n  } catch (err) {\n    console.log(err);\n    res.end('error');\n  }\n});","map":{"version":3,"sources":["/home/elian/Projeto-PalpiteBox/pages/api/save.js"],"names":["GoogleSpreadsheet","credentials","moment","doc","req","res","useServiceAccountAuth","loadInfo","sheet","sheetsByIndex","data","JSON","parse","body","sheetConfig","loadCells","mostrarPromocaoCell","getCell","textoCell","Cupom","Promo","value","format","addRow","Nome","Email","Whatsapp","Nota","end","err","console","log"],"mappings":"AAAA,SAASA,iBAAT,QAAkC,oBAAlC;AAEA,OAAOC,WAAP,MAAwB,wBAAxB;AACA,OAAOC,MAAP,MAAmB,QAAnB;AAEA,MAAMC,GAAG,GAAG,IAAIH,iBAAJ,CACV,8CADU,CAAZ;AAIA,gBAAe,OAAMI,GAAN,EAAWC,GAAX,KAAmB;AAE9B,MAAG;AACH,UAAMF,GAAG,CAACG,qBAAJ,CAA0BL,WAA1B,CAAN;AACA,UAAME,GAAG,CAACI,QAAJ,EAAN;AAEA,UAAMC,KAAK,GAAGL,GAAG,CAACM,aAAJ,CAAkB,CAAlB,CAAd;AACA,UAAMC,IAAI,GAAGC,IAAI,CAACC,KAAL,CAAWR,GAAG,CAACS,IAAf,CAAb;AAEA,UAAMC,WAAW,GAAGX,GAAG,CAACM,aAAJ,CAAkB,CAAlB,CAApB;AACA,UAAMK,WAAW,CAACC,SAAZ,CAAsB,OAAtB,CAAN;AACA,UAAMC,mBAAmB,GAAGF,WAAW,CAACG,OAAZ,CAAoB,CAApB,EAAuB,CAAvB,CAA5B;AACA,UAAMC,SAAS,GAAGJ,WAAW,CAACG,OAAZ,CAAoB,CAApB,EAAuB,CAAvB,CAAlB;AAEA,QAAIE,KAAK,GAAG,EAAZ;AACA,QAAIC,KAAK,GAAG,EAAZ;;AAEA,QAAGJ,mBAAmB,CAACK,KAApB,KAA8B,YAAjC,EAA8C;AAC5C;AACAF,MAAAA,KAAK,GAAGjB,MAAM,GAAGoB,MAAT,CAAgB,yBAAhB,CAAR;AACAF,MAAAA,KAAK,GAAGF,SAAS,CAACG,KAAlB;AACD;;AACD,UAAMb,KAAK,CAACe,MAAN,CAAa;AACfC,MAAAA,IAAI,EAAEd,IAAI,CAACc,IADI;AAEfC,MAAAA,KAAK,EAAEf,IAAI,CAACe,KAFG;AAGfC,MAAAA,QAAQ,EAAEhB,IAAI,CAACgB,QAHA;AAIfC,MAAAA,IAAI,EAAC,GAJU;AAKf,4BAAsBzB,MAAM,GAAGoB,MAAT,CAAgB,qBAAhB,CALP;AAMfH,MAAAA,KANe;AAOfC,MAAAA;AAPe,KAAb,CAAN;AASAf,IAAAA,GAAG,CAACuB,GAAJ,CAAQxB,GAAG,CAACS,IAAZ;AACC,GA9BD,CA8BC,OAAMgB,GAAN,EAAU;AACTC,IAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ;AACAxB,IAAAA,GAAG,CAACuB,GAAJ,CAAQ,OAAR;AACD;AACF,CApCH","sourcesContent":["import { GoogleSpreadsheet } from \"google-spreadsheet\";\n\nimport credentials from \"../../credentials.json\";\nimport moment from \"moment\";\n\nconst doc = new GoogleSpreadsheet(\n  \"1G_U7ODPp3tY22lO5fhURhxCtos6VAvQcGUJvRMsX1eE\"\n);\n\nexport default async(req, res) => {\n    \n    try{\n    await doc.useServiceAccountAuth(credentials)\n    await doc.loadInfo()\n    \n    const sheet = doc.sheetsByIndex[1]\n    const data = JSON.parse(req.body)\n\n    const sheetConfig = doc.sheetsByIndex[2];\n    await sheetConfig.loadCells(\"A3:B3\");\n    const mostrarPromocaoCell = sheetConfig.getCell(2, 0);\n    const textoCell = sheetConfig.getCell(2, 1);\n\n    let Cupom = ''\n    let Promo = ''\n\n    if(mostrarPromocaoCell.value === 'VERDADEIRO'){\n      //TO DO gerar cupom\n      Cupom = moment().format('DD/MM/YYYY HH:mm:ss SSS')\n      Promo = textoCell.value\n    }\n    await sheet.addRow({\n        Nome: data.Nome,\n        Email: data.Email,\n        Whatsapp: data.Whatsapp,\n        Nota:'5',\n        'Data Preenchimento': moment().format('DD/MM/YYYY HH:mm:ss'),\n        Cupom,\n        Promo\n    })\n    res.end(req.body)\n    }catch(err){\n      console.log(err)\n      res.end('error')\n    }\n  }   \n\n"]},"metadata":{},"sourceType":"module"}