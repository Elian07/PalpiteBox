{"ast":null,"code":"import { GoogleSpreadsheet } from \"google-spreadsheet\";\nconst doc = new GoogleSpreadsheet(process.env.SHEET_DOC_ID);\n\nconst fromBase = value => {\n  const buff = new Buffer(value, 'base64');\n  return buff.toString('ascii');\n};\n\nexport default (async (req, res) => {\n  try {\n    // await doc.useServiceAccountAuth(credentials);\n    await doc.useServiceAccountAuth({\n      client_email: process.env.SHEET_CLIENT_EMAIL,\n      private_key: fromBase64(process.env.SHEET_PRIVATE_KEY)\n    });\n    await doc.loadInfo();\n    const sheet = doc.sheetsByIndex[2];\n    await sheet.loadCells(\"A3:B3\");\n    const mostrarPromocaoCell = sheet.getCell(2, 0);\n    const textoCell = sheet.getCell(2, 1);\n    res.end(JSON.stringify({\n      showCoupon: mostrarPromocaoCell.value === \"VERDADEIRO\",\n      message: textoCell.value\n    }));\n  } catch (err) {\n    res.end(JSON.stringify({\n      showCoupon: false,\n      message: \"\"\n    }));\n  }\n});","map":{"version":3,"sources":["/home/elian/Projeto-PalpiteBox/pages/api/get-promo.js"],"names":["GoogleSpreadsheet","doc","process","env","SHEET_DOC_ID","fromBase","value","buff","Buffer","toString","req","res","useServiceAccountAuth","client_email","SHEET_CLIENT_EMAIL","private_key","fromBase64","SHEET_PRIVATE_KEY","loadInfo","sheet","sheetsByIndex","loadCells","mostrarPromocaoCell","getCell","textoCell","end","JSON","stringify","showCoupon","message","err"],"mappings":"AAAA,SAASA,iBAAT,QAAkC,oBAAlC;AAEA,MAAMC,GAAG,GAAG,IAAID,iBAAJ,CAAsBE,OAAO,CAACC,GAAR,CAAYC,YAAlC,CAAZ;;AAEA,MAAMC,QAAQ,GAAGC,KAAK,IAAI;AACxB,QAAMC,IAAI,GAAG,IAAIC,MAAJ,CAAWF,KAAX,EAAkB,QAAlB,CAAb;AACA,SAAOC,IAAI,CAACE,QAAL,CAAc,OAAd,CAAP;AACD,CAHD;;AAKA,gBAAe,OAAOC,GAAP,EAAYC,GAAZ,KAAoB;AACjC,MAAI;AACH;AACC,UAAMV,GAAG,CAACW,qBAAJ,CAA0B;AAC9BC,MAAAA,YAAY,EAAEX,OAAO,CAACC,GAAR,CAAYW,kBADI;AAE9BC,MAAAA,WAAW,EAAEC,UAAU,CAACd,OAAO,CAACC,GAAR,CAAYc,iBAAb;AAFO,KAA1B,CAAN;AAIA,UAAMhB,GAAG,CAACiB,QAAJ,EAAN;AAEA,UAAMC,KAAK,GAAGlB,GAAG,CAACmB,aAAJ,CAAkB,CAAlB,CAAd;AACA,UAAMD,KAAK,CAACE,SAAN,CAAgB,OAAhB,CAAN;AAEA,UAAMC,mBAAmB,GAAGH,KAAK,CAACI,OAAN,CAAc,CAAd,EAAiB,CAAjB,CAA5B;AAEA,UAAMC,SAAS,GAAGL,KAAK,CAACI,OAAN,CAAc,CAAd,EAAiB,CAAjB,CAAlB;AAEAZ,IAAAA,GAAG,CAACc,GAAJ,CACEC,IAAI,CAACC,SAAL,CAAe;AACbC,MAAAA,UAAU,EAAEN,mBAAmB,CAAChB,KAApB,KAA8B,YAD7B;AAEbuB,MAAAA,OAAO,EAAEL,SAAS,CAAClB;AAFN,KAAf,CADF;AAMD,GArBD,CAqBE,OAAOwB,GAAP,EAAY;AACZnB,IAAAA,GAAG,CAACc,GAAJ,CACEC,IAAI,CAACC,SAAL,CAAe;AACbC,MAAAA,UAAU,EAAE,KADC;AAEbC,MAAAA,OAAO,EAAE;AAFI,KAAf,CADF;AAMD;AACF,CA9BD","sourcesContent":["import { GoogleSpreadsheet } from \"google-spreadsheet\";\n\nconst doc = new GoogleSpreadsheet(process.env.SHEET_DOC_ID);\n\nconst fromBase = value => {\n  const buff = new Buffer(value, 'base64')\n  return buff.toString('ascii')\n}\n\nexport default async (req, res) => {\n  try {\n   // await doc.useServiceAccountAuth(credentials);\n    await doc.useServiceAccountAuth({\n      client_email: process.env.SHEET_CLIENT_EMAIL,\n      private_key: fromBase64(process.env.SHEET_PRIVATE_KEY)\n    })\n    await doc.loadInfo();\n\n    const sheet = doc.sheetsByIndex[2];\n    await sheet.loadCells(\"A3:B3\");\n\n    const mostrarPromocaoCell = sheet.getCell(2, 0);\n\n    const textoCell = sheet.getCell(2, 1);\n\n    res.end(\n      JSON.stringify({\n        showCoupon: mostrarPromocaoCell.value === \"VERDADEIRO\",\n        message: textoCell.value,\n      })\n    );\n  } catch (err) {\n    res.end(\n      JSON.stringify({\n        showCoupon: false,\n        message: \"\",\n      })\n    );\n  }\n};\n"]},"metadata":{},"sourceType":"module"}